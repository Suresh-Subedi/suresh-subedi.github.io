function generateHtmlFromTree(n){return preorder(n,"")}function preorder(n,t){for(var o=$("<ul>"),r=n,u=1,e,i,f,s,h;r!=null;)e=t===""?u:t+"."+u,i={},i.class="toclevel-"+r.headingSize+" tocsection-"+r.index,f=$("<li>",i),i={},i.class="tocnumber",i.html=e,s=$("<span>",i),i={},i.class="toctext",i.html=r.text,h=$("<span>",i),i={},i.href="#"+prefix+r.index,i.html=s.prop("outerHTML")+" "+h.prop("outerHTML"),f.append($("<a>",i)),r.child!==null&&f.append(preorder(r.child,t===""?u:e)),o.append(f),r=r.sibling,u++;return o}function addTop(n,t){return n!==null&&n!==undefined?n.sibling!==null?n.sibling=addTop(n.sibling,t):n.child!==null&&n.headingSize<t.headingSize?n.child=addTop(n.child,t):n.headingSize<t.headingSize?n.child=t:n.headingSize>t.headingSize?(t.child=n,n=t):n.headingSize===t.headingSize?n.sibling=t:console.log("tree.headingSize: "+n.headingSize+", top.headingSize: "+t.headingSize):n===null&&(n=t),n}function displayToc(){var n,t;$("#toc").html("");n=null;$(selector).each(function(t){var r=prefix+t,i;$("<div>",{id:r,"class":"toc-anchor"}).insertBefore($(this));i={};i.headingSize=$(this).prop("tagName").substr(1,1);i.index=t;i.text=$(this).html();i.child=null;i.sibling=null;n=addTop(n,i)});t=generateHtmlFromTree(n);$("#toc").html($("#toc").html()+t.prop("outerHTML"))}var numberHeadings=!0,currentWysiwyg="#text",selector=currentWysiwyg+" h1, "+currentWysiwyg+" h2, "+currentWysiwyg+" h3, "+currentWysiwyg+" h4, "+currentWysiwyg+" h5, "+currentWysiwyg+" h6",tocElement="#toc",prefix="toc-",tocTitle="Content";